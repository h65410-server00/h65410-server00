import{c as N,b as E,Q as P,a as D}from"./QItem.e710cf41.js";import{Q as R}from"./QMarkupTable.3a2cc66b.js";import{h as b,r as I,c as m,w as T,ad as k,o as $,J as j,I as O,x as z,A as q,W as d,X as f,Y as n,a4 as S,j as p,$ as U,a0 as H,Z as w,u as x}from"./index.c958989c.js";import{u as J,a as W}from"./use-virtual-scroll.5491e884.js";import{c as X,f as Y}from"./QBtn.d13105fa.js";import{g as Z}from"./use-timeout.face0ecb.js";import{Q as G}from"./QDialog.f8563754.js";import{Q as K}from"./QPage.dc4591cd.js";import{_ as ee}from"./ChangePasswordDialog.679f53ba.js";import{getChannel as te}from"./pusher.149582ef.js";import{freez as L,api as C}from"./axios.38a03c4c.js";import{u as le}from"./app-store.ddb93f8a.js";import{u as ae}from"./vue-i18n.runtime.bd082555.js";import"./use-dark.a7796580.js";import"./QInput.479a4d0c.js";function re(e,t){return b("div",e,[b("table",{class:"q-table"},t)])}const oe={list:N,table:R},se=["list","table","__qtable"];var ie=X({name:"QVirtualScroll",props:{...J,type:{type:String,default:"list",validator:e=>se.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:{default:void 0}},setup(e,{slots:t,attrs:c}){let r;const l=I(null),s=m(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:o,localResetVirtualScroll:a,padVirtualScroll:y,onVirtualScrollEvt:u}=W({virtualScrollLength:s,getVirtualScrollTarget:F,getVirtualScrollEl:V}),v=m(()=>{if(s.value===0)return[];const i=(B,M)=>({index:o.value.from+M,item:B});return e.itemsFn===void 0?e.items.slice(o.value.from,o.value.to).map(i):e.itemsFn(o.value.from,o.value.to-o.value.from).map(i)}),h=m(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),A=m(()=>e.scrollTarget!==void 0?{}:{tabindex:0});T(s,()=>{a()}),T(()=>e.scrollTarget,()=>{_(),g()});function V(){return l.value.$el||l.value}function F(){return r}function g(){r=Z(V(),e.scrollTarget),r.addEventListener("scroll",u,q.passive)}function _(){r!==void 0&&(r.removeEventListener("scroll",u,q.passive),r=void 0)}function Q(){let i=y(e.type==="list"?"div":"tbody",v.value.map(t.default));return t.before!==void 0&&(i=t.before().concat(i)),Y(t.after,i)}return k(()=>{a()}),$(()=>{g()}),j(()=>{g()}),O(()=>{_()}),z(()=>{_()}),()=>{if(t.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?re({ref:l,class:"q-table__middle "+h.value},Q()):b(oe[e.type],{...c,ref:l,class:[c.class,h.value],...A.value},Q)}}});const ne={class:"col q-pt-lg"},ce={class:"row q-pa-sm"},qe={__name:"LogsPage",setup(e){const t=le(),{t:c}=ae(),{canDeleteLog:r}=t.permissions,l=I(null),s=te("log"),o=async()=>{if(!!confirm(c("are_you_sure")))try{await C.delete("/admin/log"),l.value=null}catch(a){console.log(a)}};return k(async()=>{L(!0);try{l.value=await C.get("/admin/log"),s.bind("new-line",function(a){l.value.push(a)}),r&&(t.menue[0]={i:0,label:"Clear log",action:o})}catch(a){console.log(a)}finally{L(!1)}}),z(()=>{t.menue.length=0,s.unsubscribe(),l.value=null}),(a,y)=>(d(),f(K,{class:"row justify-center"},{default:n(()=>[S("div",ne,[S("div",ce,[S("div",null,[l.value?(d(),f(G,{key:0,class:"q-ml-xs",bordered:"",flat:""},{default:n(()=>[p(ie,{class:"bg-grey-1",style:{"max-height":"75vh"},items:l.value,separator:""},{default:n(({item:u,index:v})=>[(d(),f(E,{key:v,dense:""},{default:n(()=>[p(P,null,{default:n(()=>[p(D,{class:"text-subtitle1"},{default:n(()=>[U(H(u),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))]),_:1},8,["items"])]),_:1})):w("",!0)])]),x(t).newPasswordUserId>0?(d(),f(ee,{key:0,getStore:()=>x(t)},null,8,["getStore"])):w("",!0)])]),_:1}))}};export{qe as default};
