import{Q as fl}from"./QPage.dc4591cd.js";import{_ as vl}from"./DataGrid.62df3f11.js";import{u as et,c as Ft,d as Lt,e as Ht,b as ml,f as hl,g as gl,h as xt,i as yl,Q as bl}from"./QInput.479a4d0c.js";import{c as $e,u as wl,e as Sl,i as xl,a as Pe,q as pl,R as Cl,h as kl,p as Vl,f as _l,Q as qe}from"./QBtn.d13105fa.js";import{u as Pt,a as Mt}from"./use-dark.a7796580.js";import{c as b,h as _,y as Z,g as Oe,r as M,n as zt,B as Ie,H as G,p as pt,w as j,o as ql,x as Te,q as Il,A as Ye,M as Tl,v as Rl,z as Bl,G as El,ah as Al,ai as _e,t as ye,L as Fl,k as Ll,W as H,X as Y,Y as W,j as D,a4 as ee,ac as Hl,u as R,a0 as Je,a5 as ue,Z as X,$ as Ct,F as Pl,a6 as Ml,ad as zl}from"./index.c958989c.js";import{Q as Ge,a as $t,b as Ot,c as $l}from"./QItem.e710cf41.js";import{c as Ol,n as kt}from"./format.e99b7a5e.js";import{i as Dl,u as Ul,a as Wl,b as Kl,c as Ql,g as Nl}from"./use-timeout.face0ecb.js";import{p as Vt,u as jl,b as Xl,c as Yl,d as Jl,e as Gl,r as Zl,f as _t,g as en,h as tn,a as tt,Q as Dt}from"./QDialog.f8563754.js";import{u as ln,a as nn}from"./use-virtual-scroll.5491e884.js";import{freez as N,api as oe}from"./axios.38a03c4c.js";import{u as lt}from"./app-store.ddb93f8a.js";import{u as Ut}from"./vue-i18n.runtime.bd082555.js";import{_ as un}from"./ChangePasswordDialog.679f53ba.js";import{Q as on}from"./QSeparator.2091df92.js";import"./QMarkupTable.3a2cc66b.js";var an=$e({name:"QField",inheritAttrs:!1,props:{...et,tag:{type:String,default:"label"}},emits:Ft,setup(){return Lt(Ht({requiredForAttr:!1,tagProp:!0}))}});const rn={xs:8,sm:10,md:14,lg:20,xl:24};var sn=$e({name:"QChip",props:{...Pt,...wl,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:n,emit:l}){const{proxy:{$q:u}}=Oe(),d=Mt(e,u),a=Sl(e,rn),s=b(()=>e.selected===!0||e.icon!==void 0),f=b(()=>e.selected===!0?e.iconSelected||u.iconSet.chip.selected:e.icon),h=b(()=>e.iconRemove||u.iconSet.chip.remove),v=b(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),w=b(()=>{const r=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(r?` text-${r} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(v.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(d.value===!0?" q-chip--dark q-dark":"")}),p=b(()=>{const r=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},x={...r,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||u.lang.label.remove};return{chip:r,remove:x}});function k(r){r.keyCode===13&&m(r)}function m(r){e.disable||(l("update:selected",!e.selected),l("click",r))}function g(r){(r.keyCode===void 0||r.keyCode===13)&&(Z(r),e.disable===!1&&(l("update:modelValue",!1),l("remove")))}function z(){const r=[];v.value===!0&&r.push(_("div",{class:"q-focus-helper"})),s.value===!0&&r.push(_(Pe,{class:"q-chip__icon q-chip__icon--left",name:f.value}));const x=e.label!==void 0?[_("div",{class:"ellipsis"},[e.label])]:void 0;return r.push(_("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},pl(n.default,x))),e.iconRight&&r.push(_(Pe,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&r.push(_(Pe,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:h.value,...p.value.remove,onClick:g,onKeyup:g})),r}return()=>{if(e.modelValue===!1)return;const r={class:w.value,style:a.value};return v.value===!0&&Object.assign(r,p.value.chip,{onClick:m,onKeyup:k}),xl("div",r,z(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[Cl,e.ripple]])}}});const cn={target:{default:!0},noParentEvent:Boolean,contextMenu:Boolean};function dn({showing:e,avoidEmit:n,configureAnchorEl:l}){const{props:u,proxy:d,emit:a}=Oe(),s=M(null);let f=null;function h(m){return s.value===null?!1:m===void 0||m.touches===void 0||m.touches.length<=1}const v={};l===void 0&&(Object.assign(v,{hide(m){d.hide(m)},toggle(m){d.toggle(m),m.qAnchorHandled=!0},toggleKey(m){zt(m,13)===!0&&v.toggle(m)},contextClick(m){d.hide(m),Ie(m),G(()=>{d.show(m),m.qAnchorHandled=!0})},prevent:Ie,mobileTouch(m){if(v.mobileCleanup(m),h(m)!==!0)return;d.hide(m),s.value.classList.add("non-selectable");const g=m.target;pt(v,"anchor",[[g,"touchmove","mobileCleanup","passive"],[g,"touchend","mobileCleanup","passive"],[g,"touchcancel","mobileCleanup","passive"],[s.value,"contextmenu","prevent","notPassive"]]),f=setTimeout(()=>{f=null,d.show(m),m.qAnchorHandled=!0},300)},mobileCleanup(m){s.value.classList.remove("non-selectable"),f!==null&&(clearTimeout(f),f=null),e.value===!0&&m!==void 0&&Ol()}}),l=function(m=u.contextMenu){if(u.noParentEvent===!0||s.value===null)return;let g;m===!0?d.$q.platform.is.mobile===!0?g=[[s.value,"touchstart","mobileTouch","passive"]]:g=[[s.value,"mousedown","hide","passive"],[s.value,"contextmenu","contextClick","notPassive"]]:g=[[s.value,"click","toggle","passive"],[s.value,"keyup","toggleKey","passive"]],pt(v,"anchor",g)});function w(){Il(v,"anchor")}function p(m){for(s.value=m;s.value.classList.contains("q-anchor--skip");)s.value=s.value.parentNode;l()}function k(){if(u.target===!1||u.target===""||d.$el.parentNode===null)s.value=null;else if(u.target===!0)p(d.$el.parentNode);else{let m=u.target;if(typeof u.target=="string")try{m=document.querySelector(u.target)}catch{m=void 0}m!=null?(s.value=m.$el||m,l()):(s.value=null,console.error(`Anchor: target "${u.target}" not found`))}}return j(()=>u.contextMenu,m=>{s.value!==null&&(w(),l(m))}),j(()=>u.target,()=>{s.value!==null&&w(),k()}),j(()=>u.noParentEvent,m=>{s.value!==null&&(m===!0?w():l())}),ql(()=>{k(),n!==!0&&u.modelValue===!0&&s.value===null&&a("update:modelValue",!1)}),Te(()=>{f!==null&&clearTimeout(f),w()}),{anchorEl:s,canShow:h,anchorEvents:v}}function fn(e,n){const l=M(null);let u;function d(f,h){const v=`${h!==void 0?"add":"remove"}EventListener`,w=h!==void 0?h:u;f!==window&&f[v]("scroll",w,Ye.passive),window[v]("scroll",w,Ye.passive),u=h}function a(){l.value!==null&&(d(l.value),l.value=null)}const s=j(()=>e.noParentEvent,()=>{l.value!==null&&(a(),n())});return Te(s),{localScrollTarget:l,unconfigureScrollTarget:a,changeScrollEvent:d}}const{notPassiveCapture:Me}=Ye,ae=[];function ze(e){const n=e.target;if(n===void 0||n.nodeType===8||n.classList.contains("no-pointer-events")===!0)return;let l=Vt.length-1;for(;l>=0;){const u=Vt[l].$;if(u.type.name==="QTooltip"){l--;continue}if(u.type.name!=="QDialog")break;if(u.props.seamless!==!0)return;l--}for(let u=ae.length-1;u>=0;u--){const d=ae[u];if((d.anchorEl.value===null||d.anchorEl.value.contains(n)===!1)&&(n===document.body||d.innerRef.value!==null&&d.innerRef.value.contains(n)===!1))e.qClickOutside=!0,d.onClickOutside(e);else return}}function vn(e){ae.push(e),ae.length===1&&(document.addEventListener("mousedown",ze,Me),document.addEventListener("touchstart",ze,Me))}function qt(e){const n=ae.findIndex(l=>l===e);n>-1&&(ae.splice(n,1),ae.length===0&&(document.removeEventListener("mousedown",ze,Me),document.removeEventListener("touchstart",ze,Me)))}let It,Tt;function Rt(e){const n=e.split(" ");return n.length!==2?!1:["top","center","bottom"].includes(n[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(n[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function mn(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const Ze={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{Ze[`${e}#ltr`]=e,Ze[`${e}#rtl`]=e});function Bt(e,n){const l=e.split(" ");return{vertical:l[0],horizontal:Ze[`${l[1]}#${n===!0?"rtl":"ltr"}`]}}function hn(e,n){let{top:l,left:u,right:d,bottom:a,width:s,height:f}=e.getBoundingClientRect();return n!==void 0&&(l-=n[1],u-=n[0],a+=n[1],d+=n[0],s+=n[0],f+=n[1]),{top:l,bottom:a,height:f,left:u,right:d,width:s,middle:u+(d-u)/2,center:l+(a-l)/2}}function gn(e,n,l){let{top:u,left:d}=e.getBoundingClientRect();return u+=n.top,d+=n.left,l!==void 0&&(u+=l[1],d+=l[0]),{top:u,bottom:u+1,height:1,left:d,right:d+1,width:1,middle:d,center:u}}function yn(e,n){return{top:0,center:n/2,bottom:n,left:0,middle:e/2,right:e}}function Et(e,n,l,u){return{top:e[l.vertical]-n[u.vertical],left:e[l.horizontal]-n[u.horizontal]}}function Wt(e,n=0){if(e.targetEl===null||e.anchorEl===null||n>5)return;if(e.targetEl.offsetHeight===0||e.targetEl.offsetWidth===0){setTimeout(()=>{Wt(e,n+1)},10);return}const{targetEl:l,offset:u,anchorEl:d,anchorOrigin:a,selfOrigin:s,absoluteOffset:f,fit:h,cover:v,maxHeight:w,maxWidth:p}=e;if(Tl.is.ios===!0&&window.visualViewport!==void 0){const q=document.body.style,{offsetLeft:E,offsetTop:$}=window.visualViewport;E!==It&&(q.setProperty("--q-pe-left",E+"px"),It=E),$!==Tt&&(q.setProperty("--q-pe-top",$+"px"),Tt=$)}const{scrollLeft:k,scrollTop:m}=l,g=f===void 0?hn(d,v===!0?[0,0]:u):gn(d,f,u);Object.assign(l.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:p||"100vw",maxHeight:w||"100vh",visibility:"visible"});const{offsetWidth:z,offsetHeight:r}=l,{elWidth:x,elHeight:F}=h===!0||v===!0?{elWidth:Math.max(g.width,z),elHeight:v===!0?Math.max(g.height,r):r}:{elWidth:z,elHeight:r};let C={maxWidth:p,maxHeight:w};(h===!0||v===!0)&&(C.minWidth=g.width+"px",v===!0&&(C.minHeight=g.height+"px")),Object.assign(l.style,C);const P=yn(x,F);let T=Et(g,P,a,s);if(f===void 0||u===void 0)Xe(T,g,P,a,s);else{const{top:q,left:E}=T;Xe(T,g,P,a,s);let $=!1;if(T.top!==q){$=!0;const U=2*u[1];g.center=g.top-=U,g.bottom-=U+2}if(T.left!==E){$=!0;const U=2*u[0];g.middle=g.left-=U,g.right-=U+2}$===!0&&(T=Et(g,P,a,s),Xe(T,g,P,a,s))}C={top:T.top+"px",left:T.left+"px"},T.maxHeight!==void 0&&(C.maxHeight=T.maxHeight+"px",g.height>T.maxHeight&&(C.minHeight=C.maxHeight)),T.maxWidth!==void 0&&(C.maxWidth=T.maxWidth+"px",g.width>T.maxWidth&&(C.minWidth=C.maxWidth)),Object.assign(l.style,C),l.scrollTop!==m&&(l.scrollTop=m),l.scrollLeft!==k&&(l.scrollLeft=k)}function Xe(e,n,l,u,d){const a=l.bottom,s=l.right,f=Dl(),h=window.innerHeight-f,v=document.body.clientWidth;if(e.top<0||e.top+a>h)if(d.vertical==="center")e.top=n[u.vertical]>h/2?Math.max(0,h-a):0,e.maxHeight=Math.min(a,h);else if(n[u.vertical]>h/2){const w=Math.min(h,u.vertical==="center"?n.center:u.vertical===d.vertical?n.bottom:n.top);e.maxHeight=Math.min(a,w),e.top=Math.max(0,w-a)}else e.top=Math.max(0,u.vertical==="center"?n.center:u.vertical===d.vertical?n.top:n.bottom),e.maxHeight=Math.min(a,h-e.top);if(e.left<0||e.left+s>v)if(e.maxWidth=Math.min(s,v),d.horizontal==="middle")e.left=n[u.horizontal]>v/2?Math.max(0,v-s):0;else if(n[u.horizontal]>v/2){const w=Math.min(v,u.horizontal==="middle"?n.middle:u.horizontal===d.horizontal?n.right:n.left);e.maxWidth=Math.min(s,w),e.left=Math.max(0,w-e.maxWidth)}else e.left=Math.max(0,u.horizontal==="middle"?n.middle:u.horizontal===d.horizontal?n.left:n.right),e.maxWidth=Math.min(s,v-e.left)}var bn=$e({name:"QMenu",inheritAttrs:!1,props:{...cn,...Ul,...Pt,...jl,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:Rt},self:{type:String,validator:Rt},offset:{type:Array,validator:mn},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Wl,"click","escapeKey"],setup(e,{slots:n,emit:l,attrs:u}){let d=null,a,s,f;const h=Oe(),{proxy:v}=h,{$q:w}=v,p=M(null),k=M(!1),m=b(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),g=Mt(e,w),{registerTick:z,removeTick:r}=Xl(),{registerTimeout:x}=Kl(),{transitionProps:F,transitionStyle:C}=Yl(e),{localScrollTarget:P,changeScrollEvent:T,unconfigureScrollTarget:q}=fn(e,Ae),{anchorEl:E,canShow:$}=dn({showing:k}),{hide:U}=Ql({showing:k,canShow:$,handleShow:Ee,handleHide:c,hideOnRouteChange:m,processOnMount:!0}),{showPortal:be,hidePortal:we,renderPortal:K}=Jl(h,p,te,"menu"),Se={anchorEl:E,innerRef:p,onClickOutside(S){if(e.persistent!==!0&&k.value===!0)return U(S),(S.type==="touchstart"||S.target.classList.contains("q-dialog__backdrop"))&&Z(S),!0}},Re=b(()=>Bt(e.anchor||(e.cover===!0?"center middle":"bottom start"),w.lang.rtl)),Be=b(()=>e.cover===!0?Re.value:Bt(e.self||"top start",w.lang.rtl)),xe=b(()=>(e.square===!0?" q-menu--square":"")+(g.value===!0?" q-menu--dark q-dark":"")),De=b(()=>e.autoClose===!0?{onClick:re}:{}),pe=b(()=>k.value===!0&&e.persistent!==!0);j(pe,S=>{S===!0?(en(Ce),vn(Se)):(_t(Ce),qt(Se))});function ie(){ml(()=>{let S=p.value;S&&S.contains(document.activeElement)!==!0&&(S=S.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||S.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||S.querySelector("[autofocus], [data-autofocus]")||S,S.focus({preventScroll:!0}))})}function Ee(S){if(d=e.noRefocus===!1?document.activeElement:null,Gl(se),be(),Ae(),a=void 0,S!==void 0&&(e.touchPosition||e.contextMenu)){const ce=Rl(S);if(ce.left!==void 0){const{top:ke,left:Ue}=E.value.getBoundingClientRect();a={left:ce.left-Ue,top:ce.top-ke}}}s===void 0&&(s=j(()=>w.screen.width+"|"+w.screen.height+"|"+e.self+"|"+e.anchor+"|"+w.lang.rtl,J)),e.noFocus!==!0&&document.activeElement.blur(),z(()=>{J(),e.noFocus!==!0&&ie()}),x(()=>{w.platform.is.ios===!0&&(f=e.autoClose,p.value.click()),J(),be(!0),l("show",S)},e.transitionDuration)}function c(S){r(),we(),B(!0),d!==null&&(S===void 0||S.qClickOutside!==!0)&&(((S&&S.type.indexOf("key")===0?d.closest('[tabindex]:not([tabindex^="-"])'):void 0)||d).focus(),d=null),x(()=>{we(!0),l("hide",S)},e.transitionDuration)}function B(S){a=void 0,s!==void 0&&(s(),s=void 0),(S===!0||k.value===!0)&&(Zl(se),q(),qt(Se),_t(Ce)),S!==!0&&(d=null)}function Ae(){(E.value!==null||e.scrollTarget!==void 0)&&(P.value=Nl(E.value,e.scrollTarget),T(P.value,J))}function re(S){f!==!0?(tn(v,S),l("click",S)):f=!1}function se(S){pe.value===!0&&e.noFocus!==!0&&Vl(p.value,S.target)!==!0&&ie()}function Ce(S){l("escapeKey"),U(S)}function J(){Wt({targetEl:p.value,offset:e.offset,anchorEl:E.value,anchorOrigin:Re.value,selfOrigin:Be.value,absoluteOffset:a,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function te(){return _(Bl,F.value,()=>k.value===!0?_("div",{role:"menu",...u,ref:p,tabindex:-1,class:["q-menu q-position-engine scroll"+xe.value,u.class],style:[u.style,C.value],...De.value},kl(n.default)):null)}return Te(B),Object.assign(v,{focus:ie,updatePosition:J}),K}});const At=e=>["add","add-unique","toggle"].includes(e),wn=".*+?^${}()|[]\\",Sn=Object.keys(et);var xn=$e({name:"QSelect",inheritAttrs:!1,props:{...ln,...hl,...et,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:At},mapOptions:Boolean,emitValue:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:String,transitionHide:String,transitionDuration:[String,Number],behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:{type:[Number,String],default:void 0},onNewValue:Function,onFilter:Function},emits:[...Ft,"add","remove","inputValue","newValue","keyup","keypress","keydown","filterAbort"],setup(e,{slots:n,emit:l}){const{proxy:u}=Oe(),{$q:d}=u,a=M(!1),s=M(!1),f=M(-1),h=M(""),v=M(!1),w=M(!1);let p=null,k=null,m,g,z,r=null,x,F,C,P;const T=M(null),q=M(null),E=M(null),$=M(null),U=M(null),be=gl(e),we=yl(gt),K=b(()=>Array.isArray(e.options)?e.options.length:0),Se=b(()=>e.virtualScrollItemSize===void 0?e.optionsDense===!0?24:48:e.virtualScrollItemSize),{virtualScrollSliceRange:Re,virtualScrollSliceSizeComputed:Be,localResetVirtualScroll:xe,padVirtualScroll:De,onVirtualScrollEvt:pe,scrollTo:ie,setVirtualScrollSize:Ee}=nn({virtualScrollLength:K,getVirtualScrollTarget:Zt,getVirtualScrollEl:mt,virtualScrollItemSizeComputed:Se}),c=Ht(),B=b(()=>{const t=e.mapOptions===!0&&e.multiple!==!0,i=e.modelValue!==void 0&&(e.modelValue!==null||t===!0)?e.multiple===!0&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue]:[];if(e.mapOptions===!0&&Array.isArray(e.options)===!0){const o=e.mapOptions===!0&&m!==void 0?m:[],y=i.map(I=>Gt(I,o));return e.modelValue===null&&t===!0?y.filter(I=>I!==null):y}return i}),Ae=b(()=>{const t={};return Sn.forEach(i=>{const o=e[i];o!==void 0&&(t[i]=o)}),t}),re=b(()=>e.optionsDark===null?c.isDark.value:e.optionsDark),se=b(()=>xt(B.value)),Ce=b(()=>{let t="q-field__input q-placeholder col";return e.hideSelected===!0||B.value.length===0?[t,e.inputClass]:(t+=" q-field__input--padding",e.inputClass===void 0?t:[t,e.inputClass])}),J=b(()=>(e.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:"")),te=b(()=>K.value===0),S=b(()=>B.value.map(t=>O.value(t)).join(", ")),ce=b(()=>e.displayValue!==void 0?e.displayValue:S.value),ke=b(()=>e.optionsHtml===!0?()=>!0:t=>t!=null&&t.html===!0),Ue=b(()=>e.displayValueHtml===!0||e.displayValue===void 0&&(e.optionsHtml===!0||B.value.some(ke.value))),nt=b(()=>c.focused.value===!0?e.tabindex:-1),ut=b(()=>{const t={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-readonly":e.readonly===!0?"true":"false","aria-autocomplete":e.useInput===!0?"list":"none","aria-expanded":a.value===!0?"true":"false","aria-controls":`${c.targetUid.value}_lb`};return f.value>=0&&(t["aria-activedescendant"]=`${c.targetUid.value}_${f.value}`),t}),ot=b(()=>({id:`${c.targetUid.value}_lb`,role:"listbox","aria-multiselectable":e.multiple===!0?"true":"false"})),at=b(()=>B.value.map((t,i)=>({index:i,opt:t,html:ke.value(t),selected:!0,removeAtIndex:Jt,toggleOption:le,tabindex:nt.value}))),Qt=b(()=>{if(K.value===0)return[];const{from:t,to:i}=Re.value;return e.options.slice(t,i).map((o,y)=>{const I=de.value(o)===!0,V=Qe(o)===!0,L=t+y,A={clickable:!0,active:V,activeClass:Xt.value,manualFocus:!0,focused:!1,disable:I,tabindex:-1,dense:e.optionsDense,dark:re.value,role:"option","aria-selected":V===!0?"true":"false",id:`${c.targetUid.value}_${L}`,onClick:()=>{le(o)}};return I!==!0&&(f.value===L&&(A.focused=!0),d.platform.is.desktop===!0&&(A.onMousemove=()=>{a.value===!0&&fe(L)})),{index:L,opt:o,html:ke.value(o),label:O.value(o),selected:A.active,focused:A.focused,toggleOption:le,setOptionIndex:fe,itemProps:A}})}),Nt=b(()=>e.dropdownIcon!==void 0?e.dropdownIcon:d.iconSet.arrow.dropdown),jt=b(()=>e.optionsCover===!1&&e.outlined!==!0&&e.standout!==!0&&e.borderless!==!0&&e.rounded!==!0),Xt=b(()=>e.optionsSelectedClass!==void 0?e.optionsSelectedClass:e.color!==void 0?`text-${e.color}`:""),Q=b(()=>Ke(e.optionValue,"value")),O=b(()=>Ke(e.optionLabel,"label")),de=b(()=>Ke(e.optionDisable,"disable")),Fe=b(()=>B.value.map(t=>Q.value(t))),Yt=b(()=>{const t={onInput:gt,onChange:we,onKeydown:vt,onKeyup:dt,onKeypress:ft,onFocus:st,onClick(i){g===!0&&ye(i)}};return t.onCompositionstart=t.onCompositionupdate=t.onCompositionend=we,t});j(B,t=>{m=t,e.useInput===!0&&e.fillInput===!0&&e.multiple!==!0&&c.innerLoading.value!==!0&&(s.value!==!0&&a.value!==!0||se.value!==!0)&&(z!==!0&&ge(),(s.value===!0||a.value===!0)&&ve(""))},{immediate:!0}),j(()=>e.fillInput,ge),j(a,Ne),j(K,dl);function it(t){return e.emitValue===!0?Q.value(t):t}function We(t){if(t>-1&&t<B.value.length)if(e.multiple===!0){const i=e.modelValue.slice();l("remove",{index:t,value:i.splice(t,1)[0]}),l("update:modelValue",i)}else l("update:modelValue",null)}function Jt(t){We(t),c.focus()}function rt(t,i){const o=it(t);if(e.multiple!==!0){e.fillInput===!0&&Ve(O.value(t),!0,!0),l("update:modelValue",o);return}if(B.value.length===0){l("add",{index:0,value:o}),l("update:modelValue",e.multiple===!0?[o]:o);return}if(i===!0&&Qe(t)===!0||e.maxValues!==void 0&&e.modelValue.length>=e.maxValues)return;const y=e.modelValue.slice();l("add",{index:y.length,value:o}),y.push(o),l("update:modelValue",y)}function le(t,i){if(c.editable.value!==!0||t===void 0||de.value(t)===!0)return;const o=Q.value(t);if(e.multiple!==!0){i!==!0&&(Ve(e.fillInput===!0?O.value(t):"",!0,!0),ne()),q.value!==null&&q.value.focus(),(B.value.length===0||_e(Q.value(B.value[0]),o)!==!0)&&l("update:modelValue",e.emitValue===!0?o:t);return}if((g!==!0||v.value===!0)&&c.focus(),st(),B.value.length===0){const V=e.emitValue===!0?o:t;l("add",{index:0,value:V}),l("update:modelValue",e.multiple===!0?[V]:V);return}const y=e.modelValue.slice(),I=Fe.value.findIndex(V=>_e(V,o));if(I>-1)l("remove",{index:I,value:y.splice(I,1)[0]});else{if(e.maxValues!==void 0&&y.length>=e.maxValues)return;const V=e.emitValue===!0?o:t;l("add",{index:y.length,value:V}),y.push(V)}l("update:modelValue",y)}function fe(t){if(d.platform.is.desktop!==!0)return;const i=t>-1&&t<K.value?t:-1;f.value!==i&&(f.value=i)}function Le(t=1,i){if(a.value===!0){let o=f.value;do o=kt(o+t,-1,K.value-1);while(o!==-1&&o!==f.value&&de.value(e.options[o])===!0);f.value!==o&&(fe(o),ie(o),i!==!0&&e.useInput===!0&&e.fillInput===!0&&He(o>=0?O.value(e.options[o]):x,!0))}}function Gt(t,i){const o=y=>_e(Q.value(y),t);return e.options.find(o)||i.find(o)||t}function Ke(t,i){const o=t!==void 0?t:i;return typeof o=="function"?o:y=>y!==null&&typeof y=="object"&&o in y?y[o]:y}function Qe(t){const i=Q.value(t);return Fe.value.find(o=>_e(o,i))!==void 0}function st(t){e.useInput===!0&&q.value!==null&&(t===void 0||q.value===t.target&&t.target.value===S.value)&&q.value.select()}function ct(t){zt(t,27)===!0&&a.value===!0&&(ye(t),ne(),ge()),l("keyup",t)}function dt(t){const{value:i}=t.target;if(t.keyCode!==void 0){ct(t);return}if(t.target.value="",p!==null&&(clearTimeout(p),p=null),k!==null&&(clearTimeout(k),k=null),ge(),typeof i=="string"&&i.length!==0){const o=i.toLocaleLowerCase(),y=V=>{const L=e.options.find(A=>V.value(A).toLocaleLowerCase()===o);return L===void 0?!1:(B.value.indexOf(L)===-1?le(L):ne(),!0)},I=V=>{y(Q)!==!0&&(y(O)===!0||V===!0||ve(i,!0,()=>I(!0)))};I()}else c.clearValue(t)}function ft(t){l("keypress",t)}function vt(t){if(l("keydown",t),Fl(t)===!0)return;const i=h.value.length!==0&&(e.newValueMode!==void 0||e.onNewValue!==void 0),o=t.shiftKey!==!0&&e.multiple!==!0&&(f.value>-1||i===!0);if(t.keyCode===27){Ie(t);return}if(t.keyCode===9&&o===!1){me();return}if(t.target===void 0||t.target.id!==c.targetUid.value||c.editable.value!==!0)return;if(t.keyCode===40&&c.innerLoading.value!==!0&&a.value===!1){Z(t),he();return}if(t.keyCode===8&&(e.useChips===!0||e.clearable===!0)&&e.hideSelected!==!0&&h.value.length===0){e.multiple===!0&&Array.isArray(e.modelValue)===!0?We(e.modelValue.length-1):e.multiple!==!0&&e.modelValue!==null&&l("update:modelValue",null);return}(t.keyCode===35||t.keyCode===36)&&(typeof h.value!="string"||h.value.length===0)&&(Z(t),f.value=-1,Le(t.keyCode===36?1:-1,e.multiple)),(t.keyCode===33||t.keyCode===34)&&Be.value!==void 0&&(Z(t),f.value=Math.max(-1,Math.min(K.value,f.value+(t.keyCode===33?-1:1)*Be.value.view)),Le(t.keyCode===33?1:-1,e.multiple)),(t.keyCode===38||t.keyCode===40)&&(Z(t),Le(t.keyCode===38?-1:1,e.multiple));const y=K.value;if((C===void 0||P<Date.now())&&(C=""),y>0&&e.useInput!==!0&&t.key!==void 0&&t.key.length===1&&t.altKey===!1&&t.ctrlKey===!1&&t.metaKey===!1&&(t.keyCode!==32||C.length!==0)){a.value!==!0&&he(t);const I=t.key.toLocaleLowerCase(),V=C.length===1&&C[0]===I;P=Date.now()+1500,V===!1&&(Z(t),C+=I);const L=new RegExp("^"+C.split("").map(je=>wn.indexOf(je)>-1?"\\"+je:je).join(".*"),"i");let A=f.value;if(V===!0||A<0||L.test(O.value(e.options[A]))!==!0)do A=kt(A+1,-1,y-1);while(A!==f.value&&(de.value(e.options[A])===!0||L.test(O.value(e.options[A]))!==!0));f.value!==A&&G(()=>{fe(A),ie(A),A>=0&&e.useInput===!0&&e.fillInput===!0&&He(O.value(e.options[A]),!0)});return}if(!(t.keyCode!==13&&(t.keyCode!==32||e.useInput===!0||C!=="")&&(t.keyCode!==9||o===!1))){if(t.keyCode!==9&&Z(t),f.value>-1&&f.value<y){le(e.options[f.value]);return}if(i===!0){const I=(V,L)=>{if(L){if(At(L)!==!0)return}else L=e.newValueMode;if(Ve("",e.multiple!==!0,!0),V==null)return;(L==="toggle"?le:rt)(V,L==="add-unique"),e.multiple!==!0&&(q.value!==null&&q.value.focus(),ne())};if(e.onNewValue!==void 0?l("newValue",h.value,I):I(h.value),e.multiple!==!0)return}a.value===!0?me():c.innerLoading.value!==!0&&he()}}function mt(){return g===!0?U.value:E.value!==null&&E.value.contentEl!==null?E.value.contentEl:void 0}function Zt(){return mt()}function el(){return e.hideSelected===!0?[]:n["selected-item"]!==void 0?at.value.map(t=>n["selected-item"](t)).slice():n.selected!==void 0?[].concat(n.selected()):e.useChips===!0?at.value.map((t,i)=>_(sn,{key:"option-"+i,removable:c.editable.value===!0&&de.value(t.opt)!==!0,dense:!0,textColor:e.color,tabindex:nt.value,onRemove(){t.removeAtIndex(i)}},()=>_("span",{class:"ellipsis",[t.html===!0?"innerHTML":"textContent"]:O.value(t.opt)}))):[_("span",{[Ue.value===!0?"innerHTML":"textContent"]:ce.value})]}function ht(){if(te.value===!0)return n["no-option"]!==void 0?n["no-option"]({inputValue:h.value}):void 0;const t=n.option!==void 0?n.option:o=>_(Ot,{key:o.index,...o.itemProps},()=>_(Ge,()=>_($t,()=>_("span",{[o.html===!0?"innerHTML":"textContent"]:o.label}))));let i=De("div",Qt.value.map(t));return n["before-options"]!==void 0&&(i=n["before-options"]().concat(i)),_l(n["after-options"],i)}function tl(t,i){const o=i===!0?{...ut.value,...c.splitAttrs.attributes.value}:void 0,y={ref:i===!0?q:void 0,key:"i_t",class:Ce.value,style:e.inputStyle,value:h.value!==void 0?h.value:"",type:"search",...o,id:i===!0?c.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":t===!0||e.autofocus===!0||void 0,disabled:e.disable===!0,readonly:e.readonly===!0,...Yt.value};return t!==!0&&g===!0&&(Array.isArray(y.class)===!0?y.class=[...y.class,"no-pointer-events"]:y.class+=" no-pointer-events"),_("input",y)}function gt(t){p!==null&&(clearTimeout(p),p=null),k!==null&&(clearTimeout(k),k=null),!(t&&t.target&&t.target.qComposing===!0)&&(He(t.target.value||""),z=!0,x=h.value,c.focused.value!==!0&&(g!==!0||v.value===!0)&&c.focus(),e.onFilter!==void 0&&(p=setTimeout(()=>{p=null,ve(h.value)},e.inputDebounce)))}function He(t,i){h.value!==t&&(h.value=t,i===!0||e.inputDebounce===0||e.inputDebounce==="0"?l("inputValue",t):k=setTimeout(()=>{k=null,l("inputValue",t)},e.inputDebounce))}function Ve(t,i,o){z=o!==!0,e.useInput===!0&&(He(t,!0),(i===!0||o!==!0)&&(x=t),i!==!0&&ve(t))}function ve(t,i,o){if(e.onFilter===void 0||i!==!0&&c.focused.value!==!0)return;c.innerLoading.value===!0?l("filterAbort"):(c.innerLoading.value=!0,w.value=!0),t!==""&&e.multiple!==!0&&B.value.length!==0&&z!==!0&&t===O.value(B.value[0])&&(t="");const y=setTimeout(()=>{a.value===!0&&(a.value=!1)},10);r!==null&&clearTimeout(r),r=y,l("filter",t,(I,V)=>{(i===!0||c.focused.value===!0)&&r===y&&(clearTimeout(r),typeof I=="function"&&I(),w.value=!1,G(()=>{c.innerLoading.value=!1,c.editable.value===!0&&(i===!0?a.value===!0&&ne():a.value===!0?Ne(!0):a.value=!0),typeof V=="function"&&G(()=>{V(u)}),typeof o=="function"&&G(()=>{o(u)})}))},()=>{c.focused.value===!0&&r===y&&(clearTimeout(r),c.innerLoading.value=!1,w.value=!1),a.value===!0&&(a.value=!1)})}function ll(){return _(bn,{ref:E,class:J.value,style:e.popupContentStyle,modelValue:a.value,fit:e.menuShrink!==!0,cover:e.optionsCover===!0&&te.value!==!0&&e.useInput!==!0,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:re.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,square:jt.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...ot.value,onScrollPassive:pe,onBeforeShow:bt,onBeforeHide:nl,onShow:ul},ht)}function nl(t){wt(t),me()}function ul(){Ee()}function ol(t){ye(t),q.value!==null&&q.value.focus(),v.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function al(t){ye(t),G(()=>{v.value=!1})}function il(){const t=[_(an,{class:`col-auto ${c.fieldClass.value}`,...Ae.value,for:c.targetUid.value,dark:re.value,square:!0,loading:w.value,itemAligned:!1,filled:!0,stackLabel:h.value.length!==0,...c.splitAttrs.listeners.value,onFocus:ol,onBlur:al},{...n,rawControl:()=>c.getControl(!0),before:void 0,after:void 0})];return a.value===!0&&t.push(_("div",{ref:U,class:J.value+" scroll",style:e.popupContentStyle,...ot.value,onClick:Ie,onScrollPassive:pe},ht())),_(tt,{ref:$,modelValue:s.value,position:e.useInput===!0?"top":void 0,transitionShow:F,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:bt,onBeforeHide:rl,onHide:sl,onShow:cl},()=>_("div",{class:"q-select__dialog"+(re.value===!0?" q-select__dialog--dark q-dark":"")+(v.value===!0?" q-select__dialog--focused":"")},t))}function rl(t){wt(t),$.value!==null&&$.value.__updateRefocusTarget(c.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),c.focused.value=!1}function sl(t){ne(),c.focused.value===!1&&l("blur",t),ge()}function cl(){const t=document.activeElement;(t===null||t.id!==c.targetUid.value)&&q.value!==null&&q.value!==t&&q.value.focus(),Ee()}function me(){s.value!==!0&&(f.value=-1,a.value===!0&&(a.value=!1),c.focused.value===!1&&(r!==null&&(clearTimeout(r),r=null),c.innerLoading.value===!0&&(l("filterAbort"),c.innerLoading.value=!1,w.value=!1)))}function he(t){c.editable.value===!0&&(g===!0?(c.onControlFocusin(t),s.value=!0,G(()=>{c.focus()})):c.focus(),e.onFilter!==void 0?ve(h.value):(te.value!==!0||n["no-option"]!==void 0)&&(a.value=!0))}function ne(){s.value=!1,me()}function ge(){e.useInput===!0&&Ve(e.multiple!==!0&&e.fillInput===!0&&B.value.length!==0&&O.value(B.value[0])||"",!0,!0)}function Ne(t){let i=-1;if(t===!0){if(B.value.length!==0){const o=Q.value(B.value[0]);i=e.options.findIndex(y=>_e(Q.value(y),o))}xe(i)}fe(i)}function dl(t,i){a.value===!0&&c.innerLoading.value===!1&&(xe(-1,!0),G(()=>{a.value===!0&&c.innerLoading.value===!1&&(t>i?xe():Ne(!0))}))}function yt(){s.value===!1&&E.value!==null&&E.value.updatePosition()}function bt(t){t!==void 0&&ye(t),l("popupShow",t),c.hasPopupOpen=!0,c.onControlFocusin(t)}function wt(t){t!==void 0&&ye(t),l("popupHide",t),c.hasPopupOpen=!1,c.onControlFocusout(t)}function St(){g=d.platform.is.mobile!==!0&&e.behavior!=="dialog"?!1:e.behavior!=="menu"&&(e.useInput===!0?n["no-option"]!==void 0||e.onFilter!==void 0||te.value===!1:!0),F=d.platform.is.ios===!0&&g===!0&&e.useInput===!0?"fade":e.transitionShow}return El(St),Al(yt),St(),Te(()=>{p!==null&&clearTimeout(p),k!==null&&clearTimeout(k)}),Object.assign(u,{showPopup:he,hidePopup:ne,removeAtIndex:We,add:rt,toggleOption:le,getOptionIndex:()=>f.value,setOptionIndex:fe,moveOptionSelection:Le,filter:ve,updateMenuPosition:yt,updateInputValue:Ve,isOptionSelected:Qe,getEmittingOptionValue:it,isOptionDisabled:(...t)=>de.value.apply(null,t)===!0,getOptionValue:(...t)=>Q.value.apply(null,t),getOptionLabel:(...t)=>O.value.apply(null,t)}),Object.assign(c,{innerValue:B,fieldClass:b(()=>`q-select q-field--auto-height q-select--with${e.useInput!==!0?"out":""}-input q-select--with${e.useChips!==!0?"out":""}-chips q-select--${e.multiple===!0?"multiple":"single"}`),inputRef:T,targetRef:q,hasValue:se,showPopup:he,floatingLabel:b(()=>e.hideSelected!==!0&&se.value===!0||typeof h.value=="number"||h.value.length!==0||xt(e.displayValue)),getControlChild:()=>{if(c.editable.value!==!1&&(s.value===!0||te.value!==!0||n["no-option"]!==void 0))return g===!0?il():ll();c.hasPopupOpen===!0&&(c.hasPopupOpen=!1)},controlEvents:{onFocusin(t){c.onControlFocusin(t)},onFocusout(t){c.onControlFocusout(t,()=>{ge(),me()})},onClick(t){if(Ie(t),g!==!0&&a.value===!0){me(),q.value!==null&&q.value.focus();return}he(t)}},getControl:t=>{const i=el(),o=t===!0||s.value!==!0||g!==!0;if(e.useInput===!0)i.push(tl(t,o));else if(c.editable.value===!0){const I=o===!0?ut.value:void 0;i.push(_("input",{ref:o===!0?q:void 0,key:"d_t",class:"q-select__focus-target",id:o===!0?c.targetUid.value:void 0,value:ce.value,readonly:!0,"data-autofocus":t===!0||e.autofocus===!0||void 0,...I,onKeydown:vt,onKeyup:ct,onKeypress:ft})),o===!0&&typeof e.autocomplete=="string"&&e.autocomplete.length!==0&&i.push(_("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:dt}))}if(be.value!==void 0&&e.disable!==!0&&Fe.value.length!==0){const I=Fe.value.map(V=>_("option",{value:V,selected:!0}));i.push(_("select",{class:"hidden",name:be.value,multiple:e.multiple},I))}const y=e.useInput===!0||o!==!0?void 0:c.splitAttrs.attributes.value;return _("div",{class:"q-field__native row items-center",...y,...c.splitAttrs.listeners.value},i)},getInnerAppend:()=>e.loading!==!0&&w.value!==!0&&e.hideDropdownIcon!==!0?[_(Pe,{class:"q-select__dropdown-icon"+(a.value===!0?" rotate-180":""),name:Nt.value})]:null}),Lt(c)}});const Kt=Ll("users-store",{state:()=>({data:[],keyword:null,sortkey:"id",permissions:[],frozen:[],newPasswordUserId:0,newRow:null}),getters:{},actions:{}}),pn={class:"q-pb-md full-width text-center"},Cn={class:"text-caption"},kn={key:1,class:"text-subtitle1 text-grey"},Vn={key:0,class:"q-pb-md full-width text-center"},_n={class:"full-width text-center"},qn={key:1,class:"row justify-between q-pt-md"},In={key:0,class:"col-auto"},Tn={key:1,class:"col-auto"},Rn={key:2,class:"col-auto"},Bn={__name:"NewUserDialog",setup(e){const n=lt(),l=Kt(),{t:u}=Ut(),d=b({get:()=>l.newRow!=null,set:r=>l.newRow=null}),{canEditUserPermission:a,canBlockUser:s,canUnblockUser:f,canEditUserPassword:h,canDeleteUser:v}=n.permissions,w=l.newRow.status=="active"&&s,p=l.newRow.status!="active"&&f,k=JSON.parse(JSON.stringify(l.newRow));async function m(){N(!0);try{const r=l.newRow.username,x=l.newRow.permission,F=l.newRow.status||"active";if(r.length<4||r.length>12||x.length<4||x.length>12)throw new Error("Unvalid data");const C=l.newRow.id,{id:P}=l.permissions.filter(T=>T.name==x)[0];if(C){if(l.newRow.permission!=k.permission){const{id:q}=await oe.put(`/users/${C}/permission`,{permission_id:P});l.data.forEach(E=>{E.id==q&&(E.permission=x)})}}else{const{id:T}=await oe.post("/users",{username:r,password:r,permission_id:P});l.data.push({id:T,i:l.data.length+1,username:r,permission:x,status:F})}l.newRow=null}catch(r){console.log(r)}finally{N(!1)}}async function g(){if(!!confirm(u("are_you_sure"))){N(!0);try{const r=l.newRow.status,x=r=="active"?"block":"unblock",F=l.newRow.username;await oe.post(`/users/${x}`,{username:F}),l.data.forEach((C,P)=>{if(C.username==F){C.status=r=="active"?"blocked":"active";return}}),l.newRow=null}catch(r){console.log(r)}finally{N(!1)}}}async function z(){if(!!confirm(u("are_you_sure"))){N(!0);try{const r=l.newRow.id;await oe.delete(`/users/${r}`),l.data.forEach((x,F)=>{if(x.id==r){l.data.splice(F,1);return}}),l.newRow=null}catch(r){console.log(r)}finally{N(!1)}}}return(r,x)=>(H(),Y(tt,{modelValue:d.value,"onUpdate:modelValue":x[3]||(x[3]=F=>d.value=F)},{default:W(()=>[D(Dt,{class:"q-pa-md text-center",style:{width:"250px"}},{default:W(()=>[ee("form",{onSubmit:Hl(m,["prevent"]),class:"freez"},[ee("div",pn,[R(l).newRow.id?(H(),ue("div",kn,Je(R(l).newRow.username),1)):(H(),Y(bl,{key:0,modelValue:R(l).newRow.username,"onUpdate:modelValue":x[0]||(x[0]=F=>R(l).newRow.username=F),class:"freez"},{prepend:W(()=>[ee("span",Cn,Je(r.$t("username")+": "),1)]),_:1},8,["modelValue"]))]),R(a)?(H(),ue("div",Vn,[D(xn,{filled:"",modelValue:R(l).newRow.permission,"onUpdate:modelValue":x[1]||(x[1]=F=>R(l).newRow.permission=F),options:R(l).permissions,"option-label":"name","option-value":"name",label:r.$t("permission"),"map-options":"","emit-value":"","options-dense":"",dense:""},null,8,["modelValue","options","label"])])):X("",!0),ee("div",_n,[D(qe,{type:"submit",class:"full-width",color:"primary",label:r.$t("save")},null,8,["label"])]),R(l).newRow.id?(H(),ue("div",qn,[R(v)?(H(),ue("div",In,[D(qe,{class:"q-px-sm",label:r.$t("delete"),color:"negative",onClick:z,outline:"",dense:""},null,8,["label"])])):X("",!0),R(h)?(H(),ue("div",Tn,[D(qe,{class:"q-px-sm",label:r.$t("password"),color:"info",onClick:x[2]||(x[2]=F=>R(l).newPasswordUserId=R(l).newRow.id),outline:"",dense:""},null,8,["label"])])):X("",!0),R(w)||R(p)?(H(),ue("div",Rn,[D(qe,{class:"q-px-sm",label:R(l).newRow.status=="active"?r.$t("block"):r.$t("unblock"),color:"warning",onClick:g,outline:"",dense:""},null,8,["label"])])):X("",!0)])):X("",!0)],32)]),_:1})]),_:1},8,["modelValue"]))}},En={class:"row"},An={__name:"ViewFrozenDialog",props:["getStore"],setup(e){const n=e,l=lt(),u=n.getStore();Ut();const d=b({get:()=>u.frozen.length>0,set:f=>u.frozen.length=0}),{canUnfreezUser:a}=l.permissions;async function s(f){N(!0);try{await oe.post("/users/unfreez"),u.frozen.forEach((h,v)=>{if(h.username==f){u.frozen.splice(v,1);return}})}catch(h){console.log(h)}finally{N(!1)}}return(f,h)=>(H(),Y(tt,{modelValue:d.value,"onUpdate:modelValue":h[0]||(h[0]=v=>d.value=v)},{default:W(()=>[D(Dt,{class:"q-pa-sm text-center"},{default:W(()=>[ee("div",null,[ee("div",En,[ee("div",null,[D($l,{bordered:"",separator:"",dense:""},{default:W(()=>[D($t,{class:"bg-grey-2",header:""},{default:W(()=>[Ct(" Frozen ")]),_:1}),D(on),(H(!0),ue(Pl,null,Ml(R(u).frozen,v=>(H(),Y(Ot,{style:{"padding-right":"4px"},key:v},{default:W(()=>[D(Ge,null,{default:W(()=>[Ct(Je(v),1)]),_:2},1024),R(a)?(H(),Y(Ge,{key:0,side:""},{default:W(()=>[D(qe,{icon:"sync",size:"xs","text-color":"primary",onClick:w=>s(v),round:"",dense:""},null,8,["onClick"])]),_:2},1024)):X("",!0)]),_:2},1024))),128))]),_:1})])])])]),_:1})]),_:1},8,["modelValue"]))}},Fn={class:"q-pt-lg"},Gn={__name:"UsersPage",setup(e){const n=lt(),l=Kt(),{canViewFrozenUsers:u}=n.permissions;async function d(){try{const a=await oe.get("/users/frozen");l.frozen=a}catch(a){console.log(a)}}return zl(async()=>{N(!0);try{const a=await oe.get("/users"),{users:s,permissions:f,blocked:h}=a;s.forEach(v=>{const w=h.includes(v.username);v.status=w?"blocked":"active"}),l.permissions=f,l.data=s.map((v,w)=>(v.i=w+1,v)),u&&n.menue.push({i:1,label:"Frozen",action:d})}catch(a){console.log(a)}finally{N(!1)}}),Te(()=>{n.menue.forEach((a,s)=>{a.i===1&&n.menue.splice(s,1)}),l.$reset()}),(a,s)=>(H(),Y(fl,{class:"row justify-center"},{default:W(()=>[ee("div",Fn,[D(vl,{getStore:()=>R(l),columns:[{n:"username",w:140},{n:"permission",w:120},{n:"status",w:90}],actionLabel:"New user",permissionKey:"users",style:{"max-height":"80vh"}},null,8,["getStore"])]),R(l).newRow!=null?(H(),Y(Bn,{key:0})):X("",!0),R(l).newPasswordUserId>0?(H(),Y(un,{key:1,getStore:()=>R(l)},null,8,["getStore"])):X("",!0),R(l).frozen.length>0?(H(),Y(An,{key:2,getStore:()=>R(l)},null,8,["getStore"])):X("",!0)]),_:1}))}};export{Gn as default};
